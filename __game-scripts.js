var Activate=pc.createScript("activate");var DeviceDetection=pc.createScript("deviceDetection");function detection(e){return e}DeviceDetection.prototype.initialize=function(){!0===pc.platform.touch?device="mobile":!0===pc.platform.desktop?device="desktop":console.log("device not supported yet")};var CameraPresentation=pc.createScript("cameraPresentation");function pause(t){return t}CameraPresentation.attributes.add("pathRoot",{type:"entity",title:"Path Root"}),CameraPresentation.attributes.add("duration",{type:"number",default:10,title:"Duration Secs"}),CameraPresentation.attributes.add("control",{type:"boolean",default:!1}),CameraPresentation.attributes.add("startTime",{type:"number",default:0,title:"Start Time (Secs)",description:"Start the path from a specific point in time"}),CameraPresentation.prototype.initialize=function(){this.app.on("createPath",this.createPath,this),this.app.on("playPause",this.playPause,this);this.duration;this.createPath(this.pathRoot.children,this.duration),this.on("attr:time",(function(t,i){this.time=pc.math.clamp(this.startTime,0,this.duration)})),this.time=pc.math.clamp(this.startTime,0,this.duration),this.lookAt=new pc.Vec3,this.up=new pc.Vec3},CameraPresentation.prototype.update=function(t){!0===this.control&&(this.time+=t),this.time<this.duration?!0===this.control?save="play":(save="pause",this.app.fire("ico",!1)):(save="stop",!0===this.control&&this.app.fire("ico",!1));var i=this.time/this.duration;this.entity.setPosition(this.px.value(i),this.py.value(i),this.pz.value(i)),this.lookAt.set(this.tx.value(i),this.ty.value(i),this.tz.value(i)),this.up.set(this.ux.value(i),this.uy.value(i),this.uz.value(i)),this.entity.lookAt(this.lookAt,this.up)},CameraPresentation.prototype.playPause=function(t){this.control=t,!0===t&&this.app.fire("ico",!0)},CameraPresentation.prototype.createPath=function(t,e){var a=pc.CURVE_CARDINAL;this.px=new pc.Curve,this.px.type=a,this.py=new pc.Curve,this.py.type=a,this.pz=new pc.Curve,this.pz.type=a,this.tx=new pc.Curve,this.tx.type=a,this.ty=new pc.Curve,this.ty.type=a,this.tz=new pc.Curve,this.tz.type=a,this.ux=new pc.Curve,this.ux.type=a,this.uy=new pc.Curve,this.uy.type=a,this.uz=new pc.Curve,this.uz.type=a;var s=t,h=0,r=[],p=new pc.Vec3;for(r.push(0),i=1;i<s.length;i++){var n=s[i-1],o=s[i];p.sub2(n.getPosition(),o.getPosition()),h+=p.length(),r.push(h)}for(i=0;i<s.length;i++){var u=r[i]/h,c=s[i],d=c.getPosition();this.px.add(u,d.x),this.py.add(u,d.y),this.pz.add(u,d.z);var y=d.clone().add(c.forward);this.tx.add(u,y.x),this.ty.add(u,y.y),this.tz.add(u,y.z);var l=c.up;this.ux.add(u,l.x),this.uy.add(u,l.y),this.uz.add(u,l.z)}this.time=0,this.duration=e};var CameraManager=pc.createScript("cameraManager");function activeCamera(a){return a}CameraManager.attributes.add("Cameras",{type:"entity",title:"Cameras"}),CameraManager.prototype.initialize=function(){this.activeCamera=this.entity.findByName("PresentationCamera"),this.app.on("SwitchCamera",this.switchCamera,this),this.app.on("selectCamera",this.setCamera,this),this.app.on("enableCamera",this.enableCamera,this),this.app.on("preEnabled",this.preEnabled,this),this.loadCamera()},CameraManager.prototype.loadCamera=function(){for(var a=this.Cameras,t=0,e=a.length,onAssetLoad=function(){(t+=1)===e&&self.update()},i=0;i<a.length;i++)a[i].resource?onAssetLoad():(a[i].once("load",onAssetLoad),this.app.assets.load(a[i]));a.length||(this.enableCamera(0),this.setCamera("ExteriorCamera"))},CameraManager.prototype.setCamera=function(a){this.activeCamera.enabled=!1,this.activeCamera=this.entity.findByName(a),cam=this.activeCamera.name,this.activeCamera.enabled=!0,"HotspotCameraFloor1"==a?(this.app.fire("Mouse",!0),this.app.fire("HitBoxSwitch",!1),"none"==spot(ctrl)?this.app.fire("HotSpotSwitch","Spot0"):"Spot96"==spot(ctrl)?this.app.fire("HotSpotSwitch","Spot8"):"Spot66"==spot(ctrl)?this.app.fire("HotSpotSwitch","Spot30"):this.app.fire("HotSpotSwitch",spot(ctrl))):"HotspotCameraFloor2"==a?(this.app.fire("Mouse",!0),this.app.fire("HitBoxSwitch",!1),"Spot30"==spot(ctrl)?this.app.fire("HotSpotSwitch","Spot66"):"Spot8"==spot(ctrl)?this.app.fire("HotSpotSwitch","Spot96"):this.app.fire("HotSpotSwitch",spot(ctrl))):("ExteriorCamera"==a?this.app.fire("Enable"):"ExteriorCamera"!=a&&this.app.fire("Disable"),this.app.fire("Mouse",!1),this.app.fire("HitBoxSwitch",!0),this.app.fire("HotSpotSwitch","none"))},CameraManager.prototype.enableCamera=function(a){for(var t=0;t<this.Cameras.children.length;t++)t==a?this.Cameras.children[a].enabled=!0:this.Cameras.children[t].enabled=!1},CameraManager.prototype.preEnabled=function(a){this.Cameras.children[a].enabled=!1},CameraManager.prototype.switchCamera=function(a,t){var e=this.activeCamera.name,i=this.Cameras.children[a].name;"ControlEntity-HotspotCamera-Floor1"==i?"HotspotCameraFloor2"==e?!0===t&&(this.enableCamera(a),this.setCamera("TransitionCamera"),this.app.fire("transitionCam",e,i)):(this.enableCamera(a),this.setCamera("TransitionCamera"),this.app.fire("transitionCam",e,i)):"ControlEntity-HotspotCamera-Floor2"==i&&"HotspotCameraFloor1"==e?!0===t&&(this.enableCamera(a),this.setCamera("TransitionCamera"),this.app.fire("transitionCam",e,i)):(this.enableCamera(a),this.setCamera("TransitionCamera"),this.app.fire("transitionCam",e,i))};var CurveFunction=pc.createScript("curveFunction");CurveFunction.attributes.add("Room",{type:"entity",title:"Room"}),CurveFunction.attributes.add("Path",{type:"entity",title:"Path"}),CurveFunction.attributes.add("Hit",{type:"entity",title:"Wall"}),CurveFunction.attributes.add("Camera",{type:"entity",title:"Camera"}),CurveFunction.prototype.initialize=function(){this.app.on("NearestSpot",this.NearSpot,this),this.app.on("NearestSpotMove",this.NearSpotMove,this),this.app.on("NearestPath",this.NearPath,this),this.app.on("NearestPoint",this.controle,this),this.app.on("transitionCam",this.TransitionCam,this),this.app.on("presentationPoint",this.presentationPoint,this)},CurveFunction.prototype.NearPath=function(t,i){for(var e=0,r=[0,0,0,0],o=0,n=0,a=0,h="empty",s=0;s<this.Room.children.length;s++){var l=this.Camera.getPosition().x,p=this.Camera.getPosition().z,c=this.Room.children[s].getPosition().x,d=this.Room.children[s].getPosition().z;l>c?(n=l-c)<0&&(n=-n):(n=c-l)<0&&(n=-n),p>d?(a=p-d)<0&&(a=-a):(a=d-p)<0&&(a=-a),r[s]=n+a,e=n+a+1}for(var P=0;P<r.length;P++)e>=r[P]&&(e=r[P],o=P);"Broom1"==i&&(h="Room2"==this.Room.children[o].name?4:"Room3"==this.Room.children[o].name?7:"Room4"==this.Room.children[o].name?10:0),"Broom2"==i&&(h="Room1"==this.Room.children[o].name?1:"Room3"==this.Room.children[o].name?8:"Room4"==this.Room.children[o].name?11:0),"Broom3"==i&&(h="Room1"==this.Room.children[o].name?2:"Room2"==this.Room.children[o].name?5:"Room4"==this.Room.children[o].name?12:0),"Broom4"==i&&(h="Room1"==this.Room.children[o].name?3:"Room2"==this.Room.children[o].name?6:"Room3"==this.Room.children[o].name?9:0),this.NearPoint(h,t)},CurveFunction.prototype.NearPoint=function(t,i){for(var e=0,r=[0,0,0,0],o=0,n=0,a=0,h=0;h<this.Path.children[t].children.length;h++){var s=this.Camera.getPosition().x,l=this.Camera.getPosition().z,p=this.Path.children[t].children[h].getPosition().x,c=this.Path.children[t].children[h].getPosition().z;s>p?(n=s-p)<0&&(n=-n):(n=p-s)<0&&(n=-n),l>c?(a=l-c)<0&&(a=-a):(a=c-l)<0&&(a=-a),r[h]=n+a,e=n+a+1}for(var d=0;d<this.Path.children[t].children.length;d++)e>=r[d]&&(e=r[d],o=d);this.GetAllPoint(o,t,r,i)},CurveFunction.prototype.GetAllPoint=function(t,i,e,r){var o=[];if(o[0]=this.Camera,0!==i){for(var n=t;n<this.Path.children[i].children.length;n++)o[n+1-t]=this.Path.children[i].children[n];this.GetPathLength(o,e)}},CurveFunction.prototype.GetPathLength=function(t,i){for(var e=0,r=0;r<i.length;r++)e+=i[r];e/=5,this.app.fire("createPath",t,e)},CurveFunction.prototype.TransitionCam=function(t,i){var e=[];"HotspotCameraFloor1"==t&&(t="ControlEntity-HotspotCamera-Floor1"),"HotspotCameraFloor1"==i&&(i="ControlEntity-HotspotCamera-Floor1"),"HotspotCameraFloor2"==t&&(t="ControlEntity-HotspotCamera-Floor2"),"HotspotCameraFloor2"==i&&(i="ControlEntity-HotspotCamera-Floor2");for(var r=0;r<this.Camera.children.length;r++)this.Camera.children[r].name==t&&("ControlEntity-HotspotCamera-Floor1"==this.Camera.children[r].name||"ControlEntity-HotspotCamera-Floor2"==this.Camera.children[r].name?e[0]=this.Camera.children[r].children[0].children[0]:e[0]=this.Camera.children[r]),this.Camera.children[r].name==i&&("ControlEntity-HotspotCamera-Floor1"==this.Camera.children[r].name||"ControlEntity-HotspotCamera-Floor2"==this.Camera.children[r].name?e[1]=this.Camera.children[r].children[0].children[0]:e[1]=this.Camera.children[r]);this.app.fire("createTransition",e,5,i)},CurveFunction.prototype.MapTransition=function(t,i){for(var e=0;e<this.Camera.children.length;e++)this.Camera.children[e].name==t&&("ControlEntity-HotspotCamera-Floor1"==this.Camera.children[e].name?transition[0]=this.Camera.children[e].children[0]:transition[0]=this.Camera.children[e]);for(var r=0;this.Point.children.length;r++)this.Point.children[r].name==i&&(transition[1]=this.Point.children[r]);this.app.fire("createTransition",[],5,i)},CurveFunction.prototype.controle=function(t){for(var i=this.app.root.findByName("Presentation").children,e=0,r=[0,0,0,0],o=0,n=0,a=0,h=0;h<this.Path.children[t].children.length;h++){var s=this.Camera.children[1].getPosition().x,l=this.Camera.children[1].getPosition().z,p=this.Path.children[t].children[h].getPosition().x,c=this.Path.children[t].children[h].getPosition().z;s>p?(n=s-p)<0&&(n=-n):(n=p-s)<0&&(n=-n),l>c?(a=l-c)<0&&(a=-a):(a=c-l)<0&&(a=-a),r[h]=n+a,e=n+a+100}for(var d=0;d<this.Path.children[t].children.length;d++)e>=r[d]&&(e=r[d],o=d);for(var P=[],m=0,f=o;f<r.length;f++)m+=r[f];if(P[0]=this.Camera.children[1],10==o&&14==t&&(this.app.fire("createPath",i,30),this.app.fire("playPause",!0)),o>=0){if(o<=171)if(1===t)P[1]=this.Path.children[t].children[o+1],m/=10,this.app.fire("createPath",P,m),this.app.fire("playPause",!0);else if(2==t)P[1]=this.Path.children[t].children[o+1],m/=10,this.app.fire("createPath",P,m),this.app.fire("playPause",!0);else if(0===t)if(m/=15,0===o){var C=this.app.root.findByName("Presentation").children;pc.app.fire("createPath",C,m),pc.app.fire("playPause",!0)}else{for(var u=o;u<this.Path.children[t].children.length;u++)P[u+1-o]=this.Path.children[t].children[u];this.app.fire("createPath",P,m),this.app.fire("playPause",!0)}else{for(var v=o;v<this.Path.children[t].children.length;v++)"pause"==pause(o)?P[v-o]=this.Path.children[t].children[v]:P[v+1-o]=this.Path.children[t].children[v];for(var H=o;H<r.length;H++)m+=r[H];m/=15,this.app.fire("createPath",P,m),this.app.fire("playPause",!0)}if(172==o){var N=this.app.root.findByName("Presentation").children;m/=15,pc.app.fire("createPath",N,m),pc.app.fire("playPause",!0)}}},CurveFunction.prototype.presentationPoint=function(t){"HitPoint1"==hit&&!0===t&&this.app.fire("NearestPoint",3),"HitPoint2"==hit&&(!0===t?this.app.fire("NearestPoint",4):this.app.fire("NearestPoint",16)),"HitPoint3"==hit&&(!0===t?this.app.fire("NearestPoint",5):this.app.fire("NearestPoint",17)),"HitPoint4"==hit&&(!0===t?this.app.fire("NearestPoint",6):this.app.fire("NearestPoint",18)),"HitPoint5"==hit&&(!0===t?this.app.fire("NearestPoint",7):this.app.fire("NearestPoint",19)),"HitPoint6"==hit&&(!0===t?this.app.fire("NearestPoint",8):this.app.fire("NearestPoint",20)),"HitPoint7"==hit&&(!0===t?this.app.fire("NearestPoint",9):this.app.fire("NearestPoint",21)),"HitPoint8"==hit&&(!0===t?this.app.fire("NearestPoint",10):this.app.fire("NearestPoint",22)),"HitPoint9"==hit&&(!0===t?this.app.fire("NearestPoint",11):this.app.fire("NearestPoint",23)),"HitPoint10"==hit&&(!0===t?this.app.fire("NearestPoint",12):this.app.fire("NearestPoint",24)),"HitPoint11"==hit&&(!0===t?this.app.fire("NearestPoint",13):this.app.fire("NearestPoint",25)),"HitPoint12"==hit&&(!0===t?this.app.fire("NearestPoint",14):this.app.fire("NearestPoint",26)),"HitPoint13"==hit&&(!0===t?this.app.fire("NearestPoint",15):this.app.fire("NearestPoint",27)),"HitPoint14"==hit&&!1===t&&this.app.fire("NearestPoint",28)},CurveFunction.prototype.NearSpot=function(t){var i=0,e=[0,0,0,0],r=0,o=0,n=0,a=0,h=0;h="1stFloor"==floor(selector)?0:1;for(var s=0;s<this.Hit.children[h].children.length;s++)for(var l=0;l<this.Hit.children[h].children[s].children.length;l++){a++;var p=t.x,c=t.z,d=this.Hit.children[h].children[s].children[l].getPosition().x,P=this.Hit.children[h].children[s].children[l].getPosition().z;p>d?(o=p-d)<0&&(o=-o):(o=d-p)<0&&(o=-o),c>P?(n=c-P)<0&&(n=-n):(n=P-c)<0&&(n=-n),e[a]=o+n,i=o+n+1}for(var m=0,f=0;f<this.Hit.children[h].children.length;f++)i>=e[++m]&&(i=e[m],r=f);i<1.3?this.app.fire("HotSpotSwitch",this.Hit.children[h].children[r].name):this.app.fire("HotSpotSwitch","none")},CurveFunction.prototype.NearSpotMove=function(t){var i=0,e=[0,0,0,0],r=0,o=0,n=0,a=0,h=0;h="1stFloor"==floor(selector)?0:1;for(var s=0;s<this.Hit.children[h].children.length;s++)for(var l=0;l<this.Hit.children[h].children[s].children.length;l++){a++;var p=t.x,c=t.z,d=this.Hit.children[h].children[s].children[l].getPosition().x,P=this.Hit.children[h].children[s].children[l].getPosition().z;p>d?(o=p-d)<0&&(o=-o):(o=d-p)<0&&(o=-o),c>P?(n=c-P)<0&&(n=-n):(n=P-c)<0&&(n=-n),e[a]=o+n,i=o+n+1}for(var m=0,f=0;f<this.Hit.children[h].children.length;f++)i>=e[++m]&&(i=e[m],r=f);this.app.fire("move",this.Hit.children[h].children[r].getPosition())};var Trigger=pc.createScript("trigger");function trigger(r){return r}Trigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},Trigger.prototype.onTriggerEnter=function(r){hit=this.entity.name};var Ui=pc.createScript("ui");Ui.attributes.add("css",{type:"asset",assetType:"css",title:"CSS Asset"}),Ui.attributes.add("css1",{type:"asset",assetType:"css",title:"CSS Intro"}),Ui.attributes.add("css2",{type:"asset",assetType:"css",title:"CSS Intro Style"}),Ui.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),Ui.attributes.add("html1",{type:"asset",assetType:"html",title:"HTML Asset 1"}),Ui.attributes.add("html2",{type:"asset",assetType:"html",title:"HTML Asset 2"}),Ui.attributes.add("html3",{type:"asset",assetType:"html",title:"HTML Asset 3"}),Ui.attributes.add("html4",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("html5",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("html6",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("html7",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("html8",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("html9",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("html10",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("html11",{type:"asset",assetType:"html",title:"HTML map asset"}),Ui.attributes.add("htmlForm",{type:"asset",assetType:"html",title:"HTML form asset"}),Ui.prototype.initialize=function(){this.app.on("ico",this.ico,this),this.app.on("control",this.control,this);var e=document.createElement("style");document.head.appendChild(e),e.innerHTML+=this.css.resource||"",e.innerHTML+=this.css1.resource||"",e.innerHTML+=this.css2.resource||"",this.form=!1,this.presentation=!1,this.fullScreen=!1,this.count=0,this.divZ=document.createElement("div"),this.divZ.classList.add("containerForm"),this.divZ.innerHTML=this.htmlForm.resource||"",this.div=document.createElement("div"),this.div.classList.add("ControlButton"),this.div.innerHTML=this.html1.resource||"",this.divA=document.createElement("div"),this.divA.classList.add("ControlPlayer"),this.divA.innerHTML=this.html.resource||"",this.divB=document.createElement("div"),this.divB.classList.add("ModeButton"),this.divB.innerHTML=this.html2.resource||"",this.divC=document.createElement("div"),this.divC.classList.add("MenuButton"),this.divC.innerHTML=this.html3.resource||"",this.divD=document.createElement("div"),this.divD.classList.add("ToggleButton"),this.divD.innerHTML=this.html5.resource||"",this.divE=document.createElement("div"),this.divE.classList.add("Play"),this.divE.innerHTML=this.html4.resource||"",this.divF=document.createElement("div"),this.divF.classList.add("Pause"),this.divF.innerHTML=this.html6.resource||"",this.divG=document.createElement("div"),this.divG.classList.add("Ground"),this.divG.innerHTML=this.html7.resource||"",this.divH=document.createElement("div"),this.divH.classList.add("1stFloor"),this.divH.innerHTML=this.html8.resource||"",this.divI=document.createElement("div"),this.divI.classList.add("Roof"),this.divI.innerHTML=this.html9.resource||"",this.divJ=document.createElement("div"),this.divJ.classList.add("ExteriorT"),this.divJ.innerHTML=this.html10.resource||"",this.divK=document.createElement("div"),this.divK.classList.add("ModeE"),this.divK.innerHTML=this.html11.resource||"",document.body.appendChild(this.divB),document.body.appendChild(this.divC),document.body.appendChild(this.div),console.log(document.getElementsByClassName("Menu")),this.bindEvents();var t=this.divB,o=introJs();o.setOptions({steps:[{element:"#step1",intro:"<p class ='introTitle'>First chose the tour mode:</p> <p class ='centreText'>1. Explore - you direct the route</p> <img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Explore+(3).png'><br><p class ='centreText'>2. Presentation - best for first-timers</p> <img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Presentation.png'><br><p class ='centreText'>"},{element:"#step2",intro:"<p class ='introTitle'>Show the exterior of the building</p> <p class ='centreText'>Click here to show or hide the exterior of the building</p>",position:"left"},{element:"#step3",intro:"<p class ='introTitle'>In “Explore” mode select the view</p> <p class ='centreText'>1.  Walking - walk through the building</p><img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Walking.png'><br><p class ='centreText'>2.  Panorama - see the building from above</p><img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Panorama.png'>",position:"left"},{element:"#step4",intro:"<p class ='introTitle'>Get in Contact</p> <p class ='centreText'>Send a message and we’ll reply quickly </p>",position:"left"}]}),o.start(),o.onexit((function(e){for(var o=0;o<document.body.children.length;o++)"ModeButton"==document.body.children[o].className&&(document.body.removeChild(t),o-=1,pc.app.fire("FloorUp",2),num(2));pc.app.fire("SwitchCamera",2,!1)})),o.oncomplete((function(){pc.app.fire("SwitchCamera",2,!1),pc.app.fire("FloorUp",2),num(2)})),o.onchange((function(e){if("step3"==e.id)for(var o=0;o<document.body.children.length;o++)"ModeButton"==document.body.children[o].className&&(document.body.removeChild(t),o-=1);else("step2"==e.id||"step4"==e.id)&&document.body.appendChild(t)}))},Ui.prototype.ico=function(e){if(!1===e)for(var t=0;t<document.body.children.length;t++)"Pause"==document.body.children[t].className&&(document.body.removeChild(this.divF),document.body.appendChild(this.divE),t-=1);else for(var o=0;o<document.body.children.length;o++)"Play"==document.body.children[o].className&&(document.body.removeChild(this.divE),document.body.appendChild(this.divF),o-=1)},Ui.prototype.bindEvents=function(){var e=this.divK.querySelector(".OrbitE"),t=this.divK.querySelector(".Explore"),o=this.divD.querySelector(".Explore"),d=this.divD.querySelector(".Ext"),n=this.divD.children[0].querySelector(".Up"),i=this.divD.children[0].querySelector(".Down"),c=this.div.querySelector(".Orbit"),s=this.div.querySelector(".Ext"),r=this.divA.children[0].querySelector(".Backward"),l=this.divE.querySelector(".Play"),a=this.divF.querySelector(".Pause"),m=this.divA.children[0].querySelector(".Forward"),h=this.divB.children[0].querySelector(".ModeButton"),u=this.divB.children[0].querySelector(".Exploration"),p=this.divB.children[0].querySelector(".Presentation"),y=this.divB.children[0].querySelector(".VR"),b=this.divC.children[0].querySelector(".FullScreen"),v=this.divC.children[0].querySelector(".Mode"),C=this.divC.children[0].querySelector(".Help"),f=this.divC.children[0].querySelector(".Share"),g=this.divC.children[1].querySelector(".Form"),E=1,N=this.divZ,T=this.div,L=(this.divC,this.divA),w=this.divB,P=this.divD,S=this.divE,M=this.divF,x=this.divG,B=this.divH,F=this.divI,U=this.divJ,H=this.divK,I=!1;g&&g.addEventListener("click",(function(){!0===I?(document.body.removeChild(N),I=!1):(document.body.appendChild(N),I=!0)}),!1),s&&s.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}document.body.appendChild(H),pc.app.fire("FloorUp",2),num(count=2),"ExteriorCamera"!=activeCamera(cam)&&(E=0,pc.app.fire("SwitchCamera",E,!1))}),!1),d&&d.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}document.body.appendChild(H),pc.app.fire("FloorUp",2),num(count=2),"ExteriorCamera"!=activeCamera(cam)&&(E=0,pc.app.fire("SwitchCamera",E,!1))}),!1),n&&n.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++)"1stFloor"==document.body.children[e].className&&(document.body.removeChild(B),document.body.appendChild(F),e=document.body.children.length-1),"Ground"==document.body.children[e].className&&(document.body.removeChild(x),document.body.appendChild(B),e=document.body.children.length-1);pc.app.fire("UpdateFocus","Up"),pc.app.fire("SwitchFloor","Up")}),!1),i&&i.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++)"1stFloor"==document.body.children[e].className&&(document.body.removeChild(B),document.body.appendChild(x),e=document.body.children.length-1),"Roof"==document.body.children[e].className&&(document.body.removeChild(F),document.body.appendChild(B),e=document.body.children.length-1);pc.app.fire("UpdateFocus","Down"),pc.app.fire("SwitchFloor","Down")}),!1),c&&c.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}"ExteriorCamera"!=activeCamera(cam)&&(E=0,pc.app.fire("SwitchCamera",E,!1)),pc.app.fire("FloorDown",1),num(count=0),document.body.appendChild(P),document.body.appendChild(x)}),!1),e&&e.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}"ExteriorCamera"!=activeCamera(cam)&&(E=0,pc.app.fire("SwitchCamera",E,!1)),pc.app.fire("FloorDown",1),num(count=0),document.body.appendChild(P),document.body.appendChild(x)}),!1),o&&o.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}E=2,pc.app.fire("SwitchCamera",E,!1),document.body.appendChild(T),pc.app.fire("FloorUp",2),num(count=2)}),!1),t&&t.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}E=2,pc.app.fire("SwitchCamera",E,!1),document.body.appendChild(T),pc.app.fire("FloorUp",2),num(count=2)}),!1),r&&r.addEventListener("click",(function(){pc.app.fire("presentationPoint",!1)}),!1),y&&(y.addEventListener("mouseenter",(function(){document.getElementById("vrPop").classList.toggle("show")}),!1),y.addEventListener("mouseleave",(function(){document.getElementById("vrPop").classList.toggle("show")}),!1)),l&&l.addEventListener("click",(function(){"play"==pause(save)?pc.app.fire("playPause",!1):"pause"==pause(save)?pc.app.fire("playPause",!0):"stop"==pause(save)&&pc.app.fire("NearestPoint",0)}),!1),a&&a.addEventListener("click",(function(){"play"==pause(save)?pc.app.fire("playPause",!1):"pause"==pause(save)?pc.app.fire("playPause",!0):"stop"==pause(save)&&pc.app.fire("NearestPoint",0)}),!1),m&&m.addEventListener("click",(function(){pc.app.fire("presentationPoint",!0)}),!1),p&&(p.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}document.body.appendChild(L),document.body.appendChild(S),document.body.removeChild(w),!1,E=1,pc.app.fire("FloorUp",2),num(count=2),pc.app.fire("SwitchCamera",E,!1)}),!1),p.addEventListener("mouseenter",(function(){document.getElementById("presentationPop").classList.toggle("show")}),!1),p.addEventListener("mouseleave",(function(){document.getElementById("presentationPop").classList.toggle("show")}),!1)),u&&(u.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++){if("ControlButton"==document.body.children[e].className&&(document.body.removeChild(T),e-=1),"ControlPlayer"==document.body.children[e].className&&(document.body.removeChild(L),e-=1),"ModeE"==document.body.children[e].className&&(document.body.removeChild(H),e-=1),"ToggleButton"==document.body.children[e].className){document.body.removeChild(P),e-=1;for(var t=0;t<document.body.children.length;t++)"Ground"==document.body.children[t].className&&(document.body.removeChild(x),t-=1),"1stFloor"==document.body.children[t].className&&(document.body.removeChild(B),t-=1),"Roof"==document.body.children[t].className&&(document.body.removeChild(F),t-=1),"ExteriorT"==document.body.children[t].className&&(document.body.removeChild(U),t-=1)}"Play"==document.body.children[e].className&&(document.body.removeChild(S),e-=1),"Pause"==document.body.children[e].className&&(document.body.removeChild(M),e-=1)}E=2,pc.app.fire("SwitchCamera",E,!1),document.body.appendChild(T),document.body.removeChild(w),!0,pc.app.fire("FloorUp",2),num(count=2)}),!1),u.addEventListener("mouseenter",(function(){document.getElementById("explorationPop").classList.toggle("show")}),!1),u.addEventListener("mouseleave",(function(){document.getElementById("explorationPop").classList.toggle("show")}),!1)),h&&h.addEventListener("click",(function(){document.body.removeChild(w)}),!1),b&&b.addEventListener("click",(function(){!1===this.fullScreen?(pc.app.enableFullscreen(document.body),this.fullScreen=!0):(pc.app.disableFullscreen(),this.fullScreen=!1)}),!1),v&&v.addEventListener("click",(function(){document.body.appendChild(w)}),!1),C&&C.addEventListener("click",(function(){for(var e=0;e<document.body.children.length;e++)"ModeButton"!=document.body.children[e].className&&document.body.appendChild(w);var t=introJs();t.setOptions({steps:[{element:"#step1",intro:"<p class ='introTitle'>First chose the tour mode:</p> <p class ='centreText'>1. Explore - you direct the route</p> <img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Explore+(3).png'><br><p class ='centreText'>2. Presentation - best for first-timers</p> <img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Presentation.png'><br><p class ='centreText'>"},{element:"#step2",intro:"<p class ='introTitle'>Show the exterior of the building</p> <p class ='centreText'>Click here to show or hide the exterior of the building</p>",position:"left"},{element:"#step3",intro:"<p class ='introTitle'>In “Explore” mode select the view</p> <p class ='centreText'>1.  Walking - walk through the building</p><img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Walking.png'><br><p class ='centreText'>2.  Panorama - see the building from above</p><img class='introImg' src='https://s3.amazonaws.com/aws-website-testvideopc-tuqrz/Intro/Panorama.png'>",position:"left"},{element:"#step4",intro:"<p class ='introTitle'>Get in Contact</p> <p class ='centreText'>Send a message and we’ll reply quickly </p>",position:"left"}]}),t.start(),t.onexit((function(e){for(var t=0;t<document.body.children.length;t++)"ModeButton"==document.body.children[t].className&&(document.body.removeChild(w),t-=1,pc.app.fire("FloorUp",2),num(count=2));pc.app.fire("SwitchCamera",2,!1)})),t.oncomplete((function(){pc.app.fire("SwitchCamera",2,!1),pc.app.fire("FloorUp",2),num(count=2)})),t.onchange((function(e){if("step3"==e.id)for(var t=0;t<document.body.children.length;t++)"ModeButton"==document.body.children[t].className&&(document.body.removeChild(w),t-=1);else("step2"==e.id||"step4"==e.id)&&document.body.appendChild(w)}))}),!1),f&&(f.addEventListener("click",(function(){}),!1),f.addEventListener("mouseenter",(function(){document.getElementById("sharePop").classList.toggle("show")}),!1),f.addEventListener("mouseleave",(function(){document.getElementById("sharePop").classList.toggle("show")}),!1))};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:50,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:10,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:15,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:.05,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.UpdateFocus=function(t){"Up"==newtarget&&(this.focusEntity=this.app.root.findByName("First Floor - Bulding"),this._buildAabb(this.focusEntity||this.app.root,0)),this.initialize()},OrbitCamera.prototype.initialize=function(){this.app.on("UpedateFocus",this.UpdateFocus,this);var t=this,onWindowResize=function(){t._checkAspectRatio()};window.addEventListener("resize",onWindowResize,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var i=this.entity.getRotation();if(this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:distanceMax",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:pitchAngleMin",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:pitchAngleMax",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:focusEntity",(function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)})),this.on("attr:frameOnStart",(function(t,i){t&&this.focus(this.focusEntity||this.app.root)})),this.on("destroy",(function(){window.removeEventListener("resize",onWindowResize,!1)}))},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if("desktop"==detection(device)&&(this.orbitCamera=this.entity.script.orbitCamera,this.app.on("Enable",this.Enable,this),this.app.on("Disable",this.Disable,this),this.orbitCamera)){var t=this,onMouseOut=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",onMouseOut,!1),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",onMouseOut,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.Enable=function(){this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)},MouseInput.prototype.Disable=function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)},MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,s=MouseInput.toWorldPoint,e=MouseInput.worldDiff,i=this.entity.camera,n=this.orbitCamera.distance;i.screenToWorld(t.x,t.y,n,o),i.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,s),e.sub2(s,o),this.orbitCamera.pivotPoint.add(e)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!0}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};var SpotAndClick=pc.createScript("spotAndClick");SpotAndClick.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),SpotAndClick.attributes.add("playerEntity",{type:"entity",title:"Control Entity"}),SpotAndClick.attributes.add("playerSpeed",{type:"number",default:0,title:"Control Speed"}),SpotAndClick.attributes.add("Spot",{type:"entity",title:"Spot"}),SpotAndClick.prototype.initialize=function(){this.mouseLocation=0,this.app.on("move",this.movePlayerTo,this),"HotspotCameraFloor1"==this.cameraEntity.name?this.groundShape=new pc.BoundingBox(new pc.Vec3(0,0,0),new pc.Vec3(22,.8,22)):this.groundShape=new pc.BoundingBox(new pc.Vec3(0,3.2,0),new pc.Vec3(22,.1,22)),this.direction=new pc.Vec3,this.distanceToTravel=0,this.targetPosition=new pc.Vec3,this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseUp,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStart,this)},SpotAndClick.newPosition=new pc.Vec3,SpotAndClick.prototype.update=function(t){if(this.direction.lengthSq()>0){var i=this.playerSpeed*t,e=SpotAndClick.newPosition;e.copy(this.direction).scale(i),e.add(this.playerEntity.getPosition()),this.playerEntity.setPosition(e),this.distanceToTravel-=i,this.distanceToTravel<=0&&this.playerEntity.setPosition(this.targetPosition)}},SpotAndClick.prototype.movePlayerTo=function(t){this.targetPosition.copy(t),this.targetPosition.y=this.playerEntity.getPosition().y,this.distanceTravelled=0,this.direction.sub2(this.targetPosition,this.playerEntity.getPosition()),this.distanceToTravel=this.direction.length(),this.distanceToTravel>0&&this.direction.normalize()},SpotAndClick.prototype.onMouseDown=function(t){t.button==pc.MOUSEBUTTON_LEFT&&this.doRayCast(t)},SpotAndClick.prototype.onMouseUp=function(t){this.mouseLocation=t},SpotAndClick.prototype.onTouchStart=function(t){1==t.touches.length&&(this.doRayCast(t.touches[0]),t.event.preventDefault())},SpotAndClick.ray=new pc.Ray,SpotAndClick.hitPosition=new pc.Vec3,SpotAndClick.prototype.doRayCast=function(t){var i=this.cameraEntity.getPosition(),e=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip),o=SpotAndClick.ray,a=SpotAndClick.hitPosition,n=!1,p=this.mouseLocation;this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip,o.direction),o.origin.copy(this.cameraEntity.getPosition()),o.direction.sub(o.origin).normalize();var s=this.app.systems.rigidbody.raycastFirst(i,e);if(s&&this.entity.children[0].children[0].name==activeCamera(cam))if("Stair1Up"==s.entity.name){this.app.root.findByName("ControlEntity-HotspotCamera-Floor2bis").setPosition(4.605,3.37,-.176),this.app.root.findByName("HotspotCameraFloor2").setPosition(4.605,4.17,-.176),pc.app.fire("SwitchCamera",4,!0);var r=new pc.Vec3(4.605,4.17,-.176);pc.app.fire("move",r),pc.app.fire("ChangeCamera",1)}else if("Stair1Down"==s.entity.name){this.app.root.findByName("ControlEntity-HotspotCamera-Floor1bis").setPosition(.275,1,-2.039),this.app.root.findByName("HotspotCameraFloor1").setPosition(.275,1.8,-2.039),pc.app.fire("SwitchCamera",2,!0);var c=new pc.Vec3(.275,1,-2.039);pc.app.fire("move",c),pc.app.fire("ChangeCamera",0)}else if("Stair2Up"==s.entity.name){this.app.root.findByName("ControlEntity-HotspotCamera-Floor2bis").setPosition(-9.822,3.37,-6.673),this.app.root.findByName("HotspotCameraFloor2").setPosition(-9.822,4.17,-6.673),pc.app.fire("SwitchCamera",4,!0);var h=new pc.Vec3(-9.822,3.37,-6.673);pc.app.fire("move",h),pc.app.fire("ChangeCamera",1)}else if("Stair2Down"==s.entity.name){this.app.root.findByName("ControlEntity-HotspotCamera-Floor1bis").setPosition(-15.613,1,-6.224),this.app.root.findByName("HotspotCameraFloor1").setPosition(-15.613,1.8,-6.224),pc.app.fire("SwitchCamera",2,!0);var y=new pc.Vec3(-15.613,1,-6.224);pc.app.fire("move",y),pc.app.fire("ChangeCamera",0)}else for(var l=0;l<this.Spot.children.length;l++)s.entity.name==this.Spot.children[l].name?(n=!0,this.app.fire("HotSpotSwitch",s.entity.name),l=this.Spot.children.length):(n=!1,this.SpotMove(p,t,s));this.groundShape.intersectsRay(o,a)&&!0===n&&this.movePlayerTo(a)},SpotAndClick.prototype.SpotMove=function(t,i,e){var o=this.app.graphicsDevice.vw,a=this.app.graphicsDevice.vh;i.x<o/100*15&&i.y>a-a/100*8.5||i.x>o-o/100*5&&i.y>a-a/100*40||i.x<o/100*11&&i.y<a/100*6||i.x>o-o/100*22&&i.y>a/100*88-a/100*8.5&&i.y<a/100*96-a/100*8.5||(t==i?this.app.fire("NearestSpotMove",e.point):t!=i&&(t.x>i.x+5||t.x<i.x-5||t.y>i.y+5||t.y<i.y-5?move=!1:this.app.fire("NearestSpotMove",e.point)))};var LookCamera=pc.createScript("lookCamera");LookCamera.attributes.add("mouseLookSensitivity",{type:"number",default:.35,title:"Mouse Look Sensitivity"}),LookCamera.attributes.add("touchLookSensitivity",{type:"number",default:.25,title:"Touch Look Sensitivity"}),LookCamera.attributes.add("snappinessFactor",{type:"number",default:.15,title:"Snappiness Factor",description:"Lower is faster"}),LookCamera.attributes.add("CameraControl",{type:"boolean",default:!0,title:"Invert camera movement"}),LookCamera.prototype.initialize=function(){this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this._tempQuat1=new pc.Quat,this._tempQuat2=new pc.Quat,this._tempVec3_1=new pc.Vec3;var t=this.entity.getLocalRotation();this.ey=this.getYaw(t)*pc.math.RAD_TO_DEG,this.ex=this.getPitch(t,this.ey)*pc.math.RAD_TO_DEG,this.targetEx=this.ex,this.targetEy=this.ey,this.moved=!1,this.app.mouse.disableContextMenu(),this.lastTouchPosition=new pc.Vec2,this.addEventCallbacks()},LookCamera.prototype.addEventCallbacks=function(){this.app.mouse&&this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this))},LookCamera.prototype.update=function(t){var e=1;this.snappinessFactor>0&&(e=t/this.snappinessFactor),this.ex=pc.math.lerp(this.ex,this.targetEx,e),this.ey=pc.math.lerp(this.ey,this.targetEy,e),this.entity.setLocalEulerAngles(this.ex,this.ey,0),this.app.keyboard.wasPressed(pc.KEY_I)&&(!1===this.CameraControl?this.CameraControl=!0:this.CameraControl=!1)},LookCamera.prototype.moveCamera=function(t,e,a){this.moved?!0===this.CameraControl?(this.targetEx-=e*a,this.targetEx=pc.math.clamp(this.targetEx,-90,90),this.targetEy-=t*a):!1===this.CameraControl&&(this.targetEx+=e*a,this.targetEx=pc.math.clamp(this.targetEx,-90,90),this.targetEy+=t*a):this.moved=!0},LookCamera.prototype.onMouseMove=function(t){activeCamera(cam)==this.entity.name&&this.app.mouse.isPressed(pc.MOUSEBUTTON_LEFT)&&this.moveCamera(t.dx,t.dy,this.mouseLookSensitivity)},LookCamera.prototype.onTouchStart=function(t){if(activeCamera(cam)==this.entity.name){var e=t.touches[0];this.lastTouchPosition.set(e.x,e.y)}},LookCamera.prototype.onTouchMove=function(t){if(activeCamera(cam)==this.entity.name){var e=t.touches[0];this.moveCamera(-(e.x-this.lastTouchPosition.x),-(e.y-this.lastTouchPosition.y),this.touchLookSensitivity),this.lastTouchPosition.set(e.x,e.y)}},LookCamera.prototype.getYaw=function(){var t=this.entity.forward.clone();return Math.atan2(-t.x,-t.z)},LookCamera.prototype.getPitch=function(t,e){var a=this._tempQuat1,o=this._tempQuat2;o.setFromEulerAngles(0,-e,0),a.mul2(o,t);var i=this._tempVec3_1;return a.transformVector(pc.Vec3.FORWARD,i),Math.atan2(i.y,-i.z)};var TransitionCamera=pc.createScript("transitionCamera");TransitionCamera.attributes.add("pathRoot",{type:"entity",title:"Path Root"}),TransitionCamera.attributes.add("name",{type:"string",default:"none",title:"Default"}),TransitionCamera.attributes.add("duration",{type:"number",default:10,title:"Duration Secs"}),TransitionCamera.attributes.add("startTime",{type:"number",default:0,title:"Start Time (Secs)",description:"Start the path from a specific point in time"}),TransitionCamera.prototype.initialize=function(){this.app.on("createTransition",this.createPath,this);var t=this.duration;this.createPath(this.pathRoot.children,t),this.on("attr:time",(function(t,i){this.time=pc.math.clamp(this.startTime,0,this.duration)})),this.time=pc.math.clamp(this.startTime,0,this.duration),this.lookAt=new pc.Vec3,this.up=new pc.Vec3},TransitionCamera.prototype.update=function(t){if(this.time+=t,this.time>this.duration){var i=this.name;"ControlEntity-HotspotCamera-Floor1"==i?(this.app.fire("enableCamera",2),this.app.fire("selectCamera","HotspotCameraFloor1")):"ControlEntity-HotspotCamera-Floor2"==i?(this.app.fire("enableCamera",4),this.app.fire("selectCamera","HotspotCameraFloor2")):"ExteriorCamera"==i?(this.app.fire("enableCamera",0),this.app.fire("selectCamera",i)):"PresentationCamera"==i?(this.app.fire("enableCamera",1),this.app.fire("selectCamera",i)):this.app.fire("selectCamera",i)}var e=this.time/this.duration;this.entity.setPosition(this.px.value(e),this.py.value(e),this.pz.value(e)),this.lookAt.set(this.tx.value(e),this.ty.value(e),this.tz.value(e)),this.up.set(this.ux.value(e),this.uy.value(e),this.uz.value(e)),this.entity.lookAt(this.lookAt,this.up)},TransitionCamera.prototype.createPath=function(t,e,a){var s=pc.CURVE_CARDINAL;this.px=new pc.Curve,this.px.type=s,this.py=new pc.Curve,this.py.type=s,this.pz=new pc.Curve,this.pz.type=s,this.tx=new pc.Curve,this.tx.type=s,this.ty=new pc.Curve,this.ty.type=s,this.tz=new pc.Curve,this.tz.type=s,this.ux=new pc.Curve,this.ux.type=s,this.uy=new pc.Curve,this.uy.type=s,this.uz=new pc.Curve,this.uz.type=s;var r=t,h=0,p=[],n=new pc.Vec3;for(p.push(0),i=1;i<r.length;i++){var o=r[i-1],u=r[i];n.sub2(o.getPosition(),u.getPosition()),h+=n.length(),p.push(h)}for(i=0;i<r.length;i++){var m=p[i]/h,l=r[i],c=l.getPosition();this.px.add(m,c.x),this.py.add(m,c.y),this.pz.add(m,c.z);var d=c.clone().add(l.forward);this.tx.add(m,d.x),this.ty.add(m,d.y),this.tz.add(m,d.z);var C=l.up;this.ux.add(m,C.x),this.uy.add(m,C.y),this.uz.add(m,C.z)}this.time=0,this.duration=e,this.name=a};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){"mobile"==detection(device)&&(this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)}))))},TouchInput.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInput.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,o=TouchInput.toWorldPoint,n=TouchInput.worldDiff,c=this.entity.camera,h=this.orbitCamera.distance;c.screenToWorld(t.x,t.y,h,i),c.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,h,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){var i=TouchInput.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var c=this.getPinchDistance(o[0],o[1]),h=c-this.lastPinchDistance;this.lastPinchDistance=c,this.orbitCamera.distance-=h*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}};var UpdatePosition=pc.createScript("updatePosition");UpdatePosition.prototype.initialize=function(){},UpdatePosition.prototype.update=function(t){};var HitBoxManager=pc.createScript("hitBoxManager");HitBoxManager.attributes.add("HitEntity",{type:"entity",title:"Hit Box"}),HitBoxManager.prototype.initialize=function(){this.loadAssets(),this.app.on("HitBoxSwitch",this.onAssetsLoaded,this)},HitBoxManager.prototype.loadAssets=function(){for(var t=this,i=this.HitEntity,e=0,o=i.length,onAssetLoad=function(){(e+=1)===o&&t.onAssetsLoaded()},s=0;s<i.length;s++)i[s].resource?onAssetLoad():(i[s].once("load",onAssetLoad),this.app.assets.load(i[s]));i.length||this.onAssetsLoaded()},HitBoxManager.prototype.onAssetsLoaded=function(t){this.HitEntity.enabled=t};var HotSpotManager=pc.createScript("hotSpotManager");function spot(t){return t}HotSpotManager.attributes.add("HotSpot",{type:"entity",title:"Hotspot"}),HotSpotManager.prototype.initialize=function(){this.loadAssets(),this.app.on("HotSpotSwitch",this.HotSpotLoad,this)},HotSpotManager.prototype.loadAssets=function(){var t=this;ctrl="none",selector="1stFloor";for(var o=this.HotSpot,e=0,n=o.length,HotSpotLoad=function(){(e+=1)===n&&t.HotSpotLoad()},r=0;r<o.length;r++)o[r].resource?HotSpotLoad():(o[r].once("load",HotSpotLoad),this.app.assets.load(o[r]));o.length||this.HotSpotLoad()},HotSpotManager.prototype.HotSpotLoad=function(t){var o;o="1stFloor"==floor(selector)?0:1;for(var e=0;e<this.HotSpot.children[o].children.length;e++)this.HotSpot.children[o].children[e].name==t?(this.HotSpot.children[o].children[e].enabled=!0,ctrl=this.HotSpot.children[o].children[e].name):this.HotSpot.children[o].children[e].enabled=!1};var FloorSelector=pc.createScript("floorSelector");function floor(o){return o}FloorSelector.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.FloorChange,this)},FloorSelector.prototype.FloorChange=function(o){selector=this.entity.name};var GroundSelection=pc.createScript("groundSelection");function spot(t){return t}GroundSelection.attributes.add("Ground",{type:"entity",title:"Building"}),GroundSelection.prototype.initialize=function(){this.loadAssets(),this.app.on("GroundSwitch",this.GroundLoad,this)},GroundSelection.prototype.loadAssets=function(){for(var t=this,o=this.Ground,n=0,e=o.length,GroundLoad=function(){(n+=1)===e&&t.HotSpotLoad()},i=0;i<o.length;i++)o[i].resource?GroundLoad():(o[i].once("load",GroundLoad),this.app.assets.load(o[i]));o.length||this.GroundLoad()},GroundSelection.prototype.GroundLoad=function(t){for(var o=0;o<this.Ground.children.length;o++)this.Ground.children[o].name==this.Ground.children[t].name?this.HotSpot.children[o].enabled=!0:this.HotSpot.children[o].enabled=!1};var MouseOver=pc.createScript("mouseOver");MouseOver.attributes.add("object",{type:"entity",title:"object"}),MouseOver.attributes.add("camera",{type:"entity",title:"camera"}),MouseOver.attributes.add("camera1",{type:"entity",title:"camera"}),MouseOver.prototype.initialize=function(){"desktop"==detection(device)&&(this.app.on("ChangeCamera",this.ChangeCamera,this),this.cameraEntity=this.camera,this.count=0,this.num=0,this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.mouseDown,this))},MouseOver.prototype.ChangeCamera=function(t){this.cameraEntity=0===t?this.camera:this.camera1},MouseOver.prototype.mouseDown=function(t){0===this.count?(this.doRaycast(t),this.count+=1):1==this.count&&(this.count=0)},MouseOver.prototype.doRaycast=function(t){var e=this.cameraEntity.getPosition(),i=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip),s=this.app.systems.rigidbody.raycastFirst(e,i);s&&(activeCamera(cam),-180==this.cameraEntity.getEulerAngles().z||180==this.cameraEntity.getEulerAngles().z?this.object.setEulerAngles(-this.cameraEntity.getEulerAngles().z,this.cameraEntity.getEulerAngles().y,-this.cameraEntity.getEulerAngles().z):this.object.setEulerAngles(0,this.cameraEntity.getEulerAngles().y,0),"Ceilling"==s.entity.name?(this.object.setPosition(s.point),0===this.num?(this.num+=1,this.app.fire("NearestSpot",s.point)):5==this.num?this.num+=1:this.num=0):("1stFloor"==floor(selector)?this.object.setPosition(s.point.x,.02,s.point.z):this.object.setPosition(s.point.x,2.58,s.point.z),0===this.num?(this.num+=1,this.app.fire("NearestSpot",s.point)):5==this.num?this.num+=1:this.num=0))};var SwitchFloor=pc.createScript("switchFloor");function num(t){return t}function Exterior(t){return t}SwitchFloor.attributes.add("object",{type:"entity",title:"objects"}),SwitchFloor.prototype.initialize=function(){this.loadAssets(),this.app.on("SwitchFloor",this.onEventUpdate,this),this.app.on("FloorUp",this.spawn,this),this.app.on("FloorDown",this.despawn,this),this.app.on("Exterior",this.exterior,this),this.app.on("NoExterior",this.NoExterior,this)},SwitchFloor.prototype.loadAssets=function(){var t=this,o=t.object,n=0,e=o.length;num(count=2);for(var onAssetLoad=function(){(n+=1)===e&&t.update()},i=0;i<o.length;i++)o[i].resource?onAssetLoad():(o[i].once("load",onAssetLoad),this.app.assets.load(o[i]));o.length||this.onEventUpdate()},SwitchFloor.prototype.onEventUpdate=function(t){"Up"==t?(num(count+=1),1==num(count)?this.spawn(1):2==num(count)?this.spawn(2):num(count=2)):"Down"==t&&(num(count-=1),0===num(count)?this.despawn(1):1==num(count)?this.despawn(2):num(count=0))},SwitchFloor.prototype.spawn=function(t){for(var o=0;o<=t;o++)this.object.children[o].enabled=!0},SwitchFloor.prototype.despawn=function(t){for(var o=2;o>=t;o--)this.object.children[o].enabled=!1},SwitchFloor.prototype.exterior=function(){!1===this.object.children[4].enabled?(this.object.children[3].enabled=!0,this.object.children[4].enabled=!0):(this.object.children[4].enabled=!1,this.object.children[3].enabled=!1)},SwitchFloor.prototype.NoExterior=function(){this.object.children[4].enabled=!1,this.object.children[3].enabled=!1};var MouseOverControl=pc.createScript("mouseOverControl");MouseOverControl.attributes.add("object",{type:"entity",title:"objects"}),MouseOverControl.prototype.initialize=function(){this.loadAssets(),this.app.on("Mouse",this.onEventUpdate,this)},MouseOverControl.prototype.loadAssets=function(){var t=this,e=t.object,o=0,n=e.length;num(count=0);for(var onAssetLoad=function(){(o+=1)===n&&t.update()},s=0;s<e.length;s++)e[s].resource?onAssetLoad():(e[s].once("load",onAssetLoad),this.app.assets.load(e[s]));e.length||this.onEventUpdate(!0)},MouseOverControl.prototype.onEventUpdate=function(t){this.object.enabled=t};!function(t,e){"object"==typeof exports?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t)}(this,(function(t){function IntroJs(t){this._targetElement=t,this._introItems=[],this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",hidePrev:!1,hideNext:!1,tooltipPosition:"bottom",tooltipClass:"",highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!0,keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!1,scrollToElement:!0,scrollTo:"element",scrollPadding:30,overlayOpacity:.8,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1,hintPosition:"top-middle",hintButtonLabel:"Got it",hintAnimation:!0}}function _introForElement(t){var e=[],i=this;if(this._options.steps)for(var n=0,o=this._options.steps.length;n<o;n++){var s=_cloneObject(this._options.steps[n]);if(s.step=e.length+1,"string"==typeof s.element&&(s.element=document.querySelector(s.element)),void 0===s.element||null==s.element){var r=document.querySelector(".introjsFloatingElement");null==r&&((r=document.createElement("div")).className="introjsFloatingElement",document.body.appendChild(r)),s.element=r,s.position="floating"}s.scrollTo=s.scrollTo||this._options.scrollTo,void 0===s.disableInteraction&&(s.disableInteraction=this._options.disableInteraction),null!=s.element&&e.push(s)}else{var l=t.querySelectorAll("*[data-intro]");if(l.length<1)return!1;n=0;for(var a=l.length;n<a;n++){if("none"!=(u=l[n]).style.display){var c=parseInt(u.getAttribute("data-step"),10),h=this._options.disableInteraction;void 0!==u.getAttribute("data-disable-interaction")&&(h=!!u.getAttribute("data-disable-interaction")),c>0&&(e[c-1]={element:u,intro:u.getAttribute("data-intro"),step:parseInt(u.getAttribute("data-step"),10),tooltipClass:u.getAttribute("data-tooltipClass"),highlightClass:u.getAttribute("data-highlightClass"),position:u.getAttribute("data-position")||this._options.tooltipPosition,scrollTo:u.getAttribute("data-scrollTo")||this._options.scrollTo,disableInteraction:h})}}var p=0;for(n=0,a=l.length;n<a;n++){var u;if(null==(u=l[n]).getAttribute("data-step")){for(;void 0!==e[p];)p++;h=this._options.disableInteraction;void 0!==u.getAttribute("data-disable-interaction")&&(h=!!u.getAttribute("data-disable-interaction")),e[p]={element:u,intro:u.getAttribute("data-intro"),step:p+1,tooltipClass:u.getAttribute("data-tooltipClass"),highlightClass:u.getAttribute("data-highlightClass"),position:u.getAttribute("data-position")||this._options.tooltipPosition,scrollTo:u.getAttribute("data-scrollTo")||this._options.scrollTo,disableInteraction:h}}}}for(var d=[],m=0;m<e.length;m++)e[m]&&d.push(e[m]);if((e=d).sort((function(t,e){return t.step-e.step})),i._introItems=e,_addOverlayLayer.call(i,t)){_nextStep.call(i);t.querySelector(".introjs-skipbutton"),t.querySelector(".introjs-nextbutton");i._onKeyDown=function(e){if(27===e.keyCode&&1==i._options.exitOnEsc)_exitIntro.call(i,t);else if(37===e.keyCode)_previousStep.call(i);else if(39===e.keyCode)_nextStep.call(i);else if(13===e.keyCode){var n=e.target||e.srcElement;n&&n.className.indexOf("introjs-prevbutton")>0?_previousStep.call(i):n&&n.className.indexOf("introjs-skipbutton")>0?(i._introItems.length-1==i._currentStep&&"function"==typeof i._introCompleteCallback&&i._introCompleteCallback.call(i),_exitIntro.call(i,t)):_nextStep.call(i),e.preventDefault?e.preventDefault():e.returnValue=!1}},i._onResize=function(t){i.refresh.call(i)},window.addEventListener?(this._options.keyboardNavigation&&window.addEventListener("keydown",i._onKeyDown,!0),window.addEventListener("resize",i._onResize,!0)):document.attachEvent&&(this._options.keyboardNavigation&&document.attachEvent("onkeydown",i._onKeyDown),document.attachEvent("onresize",i._onResize))}return!1}function _cloneObject(t){if(null==t||"object"!=typeof t||void 0!==t.nodeType)return t;var e={};for(var i in t)"undefined"!=typeof jQuery&&t[i]instanceof jQuery?e[i]=t[i]:e[i]=_cloneObject(t[i]);return e}function _goToStep(t){this._currentStep=t-2,void 0!==this._introItems&&_nextStep.call(this)}function _goToStepNumber(t){this._currentStepNumber=t,void 0!==this._introItems&&_nextStep.call(this)}function _nextStep(){if(this._direction="forward",void 0!==this._currentStepNumber)for(var t=0,e=this._introItems.length;t<e;t++){this._introItems[t].step===this._currentStepNumber&&(this._currentStep=t-1,this._currentStepNumber=void 0)}if(void 0===this._currentStep?this._currentStep=0:++this._currentStep,this._introItems.length<=this._currentStep)return"function"==typeof this._introCompleteCallback&&this._introCompleteCallback.call(this),void _exitIntro.call(this,this._targetElement);var i=this._introItems[this._currentStep];void 0!==this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,i.element),_showElement.call(this,i)}function _previousStep(){if(this._direction="backward",0===this._currentStep)return!1;var t=this._introItems[--this._currentStep];void 0!==this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,t.element),_showElement.call(this,t)}function _refresh(){if(_setHelperLayerPosition.call(this,document.querySelector(".introjs-helperLayer")),_setHelperLayerPosition.call(this,document.querySelector(".introjs-tooltipReferenceLayer")),void 0!==this._currentStep&&null!==this._currentStep){var t=document.querySelector(".introjs-helperNumberLayer"),e=document.querySelector(".introjs-arrow"),i=document.querySelector(".introjs-tooltip");_placeTooltip.call(this,this._introItems[this._currentStep].element,i,e,t)}return _reAlignHints.call(this),this}function _exitIntro(t){var e=t.querySelectorAll(".introjs-overlay");if(e&&e.length>0)for(var i=e.length-1;i>=0;i--){var n=e[i];n.style.opacity=0,setTimeout(function(){this.parentNode&&this.parentNode.removeChild(this)}.bind(n),500)}var o=t.querySelector(".introjs-helperLayer");o&&o.parentNode.removeChild(o);var s=t.querySelector(".introjs-tooltipReferenceLayer");s&&s.parentNode.removeChild(s);var r=t.querySelector(".introjs-disableInteraction");r&&r.parentNode.removeChild(r);var l=document.querySelector(".introjsFloatingElement");l&&l.parentNode.removeChild(l),_removeShowElement();var a=document.querySelectorAll(".introjs-fixParent");if(a&&a.length>0)for(i=a.length-1;i>=0;i--)a[i].className=a[i].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown),null!=this._introExitCallback&&this._introExitCallback.call(self),this._currentStep=void 0}function _placeTooltip(t,e,i,n,o){var s,r,l,a,c,h="";if(o=o||!1,e.style.top=null,e.style.right=null,e.style.bottom=null,e.style.left=null,e.style.marginLeft=null,e.style.marginTop=null,i.style.display="inherit",void 0!==n&&null!=n&&(n.style.top=null,n.style.left=null),this._introItems[this._currentStep])switch(h="string"==typeof(s=this._introItems[this._currentStep]).tooltipClass?s.tooltipClass:this._options.tooltipClass,e.className=("introjs-tooltip "+h).replace(/^\s+|\s+$/g,""),"floating"!=(c=this._introItems[this._currentStep].position)&&(c="auto"===c?_determineAutoPosition.call(this,t,e):_determineAutoPosition.call(this,t,e,c)),l=_getOffset(t),r=_getOffset(e),a=_getWinSize(),c){case"top":if(i.className="introjs-arrow bottom",o)var p=0;else p=15;_checkRight(l,p,r,a,e),e.style.bottom=l.height+20+"px";break;case"right":e.style.left=l.width+20+"px",l.top+r.height>a.height?(i.className="introjs-arrow left-bottom",e.style.top="-"+(r.height-l.height-20)+"px"):i.className="introjs-arrow left";break;case"left":o||1!=this._options.showStepNumbers||(e.style.top="15px"),l.top+r.height>a.height?(e.style.top="-"+(r.height-l.height-20)+"px",i.className="introjs-arrow right-bottom"):i.className="introjs-arrow right",e.style.right=l.width+20+"px";break;case"floating":i.style.display="none",e.style.left="50%",e.style.top="50%",e.style.marginLeft="-"+r.width/2+"px",e.style.marginTop="-"+r.height/2+"px",void 0!==n&&null!=n&&(n.style.left="-"+(r.width/2+18)+"px",n.style.top="-"+(r.height/2+18)+"px");break;case"bottom-right-aligned":i.className="introjs-arrow top-right";_checkLeft(l,0,r,e),e.style.top=l.height+20+"px";break;case"bottom-middle-aligned":i.className="introjs-arrow top-middle";var u=l.width/2-r.width/2;o&&(u+=5),_checkLeft(l,u,r,e)&&(e.style.right=null,_checkRight(l,u,r,a,e)),e.style.top=l.height+20+"px";break;default:i.className="introjs-arrow top",_checkRight(l,p=0,r,a,e),e.style.top=l.height+20+"px"}}function _checkRight(t,e,i,n,o){return t.left+e+i.width>n.width?(o.style.left=n.width-i.width-t.left+"px",!1):(o.style.left=e+"px",!0)}function _checkLeft(t,e,i,n){return t.left+t.width-e-i.width<0?(n.style.left=-t.left+"px",!1):(n.style.right=e+"px",!0)}function _determineAutoPosition(t,e,i){var n=this._options.positionPrecedence.slice(),o=_getWinSize(),s=_getOffset(e).height+10,r=_getOffset(e).width+20,l=_getOffset(t),a="floating";return l.left+r>o.width||l.left+l.width/2-r<0?(_removeEntry(n,"bottom"),_removeEntry(n,"top")):(l.height+l.top+s>o.height&&_removeEntry(n,"bottom"),l.top-s<0&&_removeEntry(n,"top")),l.width+l.left+r>o.width&&_removeEntry(n,"right"),l.left-r<0&&_removeEntry(n,"left"),n.length>0&&(a=n[0]),i&&"auto"!=i&&n.indexOf(i)>-1&&(a=i),a}function _removeEntry(t,e){t.indexOf(e)>-1&&t.splice(t.indexOf(e),1)}function _setHelperLayerPosition(t){if(t){if(!this._introItems[this._currentStep])return;var e=this._introItems[this._currentStep],i=_getOffset(e.element),n=10;_isFixed(e.element)?t.className+=" introjs-fixedTooltip":t.className=t.className.replace(" introjs-fixedTooltip",""),"floating"==e.position&&(n=0),t.setAttribute("style","width: "+(i.width+n)+"px; height:"+(i.height+n)+"px; top:"+(i.top-5)+"px;left: "+(i.left-5)+"px;")}}function _disableInteraction(){var t=document.querySelector(".introjs-disableInteraction");null===t&&((t=document.createElement("div")).className="introjs-disableInteraction",this._targetElement.appendChild(t)),_setHelperLayerPosition.call(this,t)}function _setAnchorAsButton(t){t.setAttribute("role","button"),t.tabIndex=0}function _showElement(t){void 0!==this._introChangeCallback&&this._introChangeCallback.call(this,t.element);var e=this,i=document.querySelector(".introjs-helperLayer"),n=document.querySelector(".introjs-tooltipReferenceLayer"),o="introjs-helperLayer";_getOffset(t.element);if("string"==typeof t.highlightClass&&(o+=" "+t.highlightClass),"string"==typeof this._options.highlightClass&&(o+=" "+this._options.highlightClass),null!=i){var s=n.querySelector(".introjs-helperNumberLayer"),r=n.querySelector(".introjs-tooltiptext"),l=n.querySelector(".introjs-arrow"),a=n.querySelector(".introjs-tooltip"),c=n.querySelector(".introjs-skipbutton"),h=n.querySelector(".introjs-prevbutton"),p=n.querySelector(".introjs-nextbutton");if(i.className=o,a.style.opacity=0,a.style.display="none",null!=s){var u=this._introItems[t.step-2>=0?t.step-2:0];(null!=u&&"forward"==this._direction&&"floating"==u.position||"backward"==this._direction&&"floating"==t.position)&&(s.style.opacity=0)}_setHelperLayerPosition.call(e,i),_setHelperLayerPosition.call(e,n);var d=document.querySelectorAll(".introjs-fixParent");if(d&&d.length>0)for(var m=d.length-1;m>=0;m--)d[m].className=d[m].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");_removeShowElement(),e._lastShowElementTimer&&clearTimeout(e._lastShowElementTimer),e._lastShowElementTimer=setTimeout((function(){null!=s&&(s.innerHTML=t.step),r.innerHTML=t.intro,a.style.display="block",_placeTooltip.call(e,t.element,a,l,s),e._options.showBullets&&(n.querySelector(".introjs-bullets li > a.active").className="",n.querySelector('.introjs-bullets li > a[data-stepnumber="'+t.step+'"]').className="active"),n.querySelector(".introjs-progress .introjs-progressbar").setAttribute("style","width:"+_getProgress.call(e)+"%;"),a.style.opacity=1,s&&(s.style.opacity=1),void 0!==c&&null!=c&&/introjs-donebutton/gi.test(c.className)?c.focus():void 0!==p&&null!=p&&p.focus(),_scrollTo.call(e,t.scrollTo,t,r)}),350)}else{var f=document.createElement("div"),_=document.createElement("div"),g=document.createElement("div"),v=document.createElement("div"),b=document.createElement("div"),y=document.createElement("div"),w=document.createElement("div"),C=document.createElement("div");f.className=o,_.className="introjs-tooltipReferenceLayer",_setHelperLayerPosition.call(e,f),_setHelperLayerPosition.call(e,_),this._targetElement.appendChild(f),this._targetElement.appendChild(_),g.className="introjs-arrow",b.className="introjs-tooltiptext",b.innerHTML=t.intro,y.className="introjs-bullets",!1===this._options.showBullets&&(y.style.display="none");for(var j=document.createElement("ul"),S=(m=0,this._introItems.length);m<S;m++){var E=document.createElement("li"),N=document.createElement("a");N.onclick=function(){e.goToStep(this.getAttribute("data-stepnumber"))},m===t.step-1&&(N.className="active"),_setAnchorAsButton(N),N.innerHTML="&nbsp;",N.setAttribute("data-stepnumber",this._introItems[m].step),E.appendChild(N),j.appendChild(E)}y.appendChild(j),w.className="introjs-progress",!1===this._options.showProgress&&(w.style.display="none");var x=document.createElement("div");if(x.className="introjs-progressbar",x.setAttribute("style","width:"+_getProgress.call(this)+"%;"),w.appendChild(x),C.className="introjs-tooltipbuttons",!1===this._options.showButtons&&(C.style.display="none"),v.className="introjs-tooltip",v.appendChild(b),v.appendChild(y),v.appendChild(w),1==this._options.showStepNumbers){var k=document.createElement("span");k.className="introjs-helperNumberLayer",k.innerHTML=t.step,_.appendChild(k)}v.appendChild(g),_.appendChild(v),(p=document.createElement("a")).onclick=function(){e._introItems.length-1!=e._currentStep&&_nextStep.call(e)},_setAnchorAsButton(p),p.innerHTML=this._options.nextLabel,(h=document.createElement("a")).onclick=function(){0!=e._currentStep&&_previousStep.call(e)},_setAnchorAsButton(h),h.innerHTML=this._options.prevLabel,(c=document.createElement("a")).className="introjs-button introjs-skipbutton",_setAnchorAsButton(c),c.innerHTML=this._options.skipLabel,c.onclick=function(){e._introItems.length-1==e._currentStep&&"function"==typeof e._introCompleteCallback&&e._introCompleteCallback.call(e),_exitIntro.call(e,e._targetElement)},C.appendChild(c),this._introItems.length>1&&(C.appendChild(h),C.appendChild(p)),v.appendChild(C),_placeTooltip.call(e,t.element,v,g,k),_scrollTo.call(this,t.scrollTo,t,v)}var A=e._targetElement.querySelector(".introjs-disableInteraction");A&&A.parentNode.removeChild(A),t.disableInteraction&&_disableInteraction.call(e),void 0!==p&&null!=p&&p.removeAttribute("tabIndex"),void 0!==h&&null!=h&&h.removeAttribute("tabIndex"),0==this._currentStep&&this._introItems.length>1?(void 0!==c&&null!=c&&(c.className="introjs-button introjs-skipbutton"),void 0!==p&&null!=p&&(p.className="introjs-button introjs-nextbutton"),1==this._options.hidePrev?(void 0!==h&&null!=h&&(h.className="introjs-button introjs-prevbutton introjs-hidden"),void 0!==p&&null!=p&&(p.className+=" introjs-fullbutton")):void 0!==h&&null!=h&&(h.className="introjs-button introjs-prevbutton introjs-disabled"),void 0!==h&&null!=h&&(h.tabIndex="-1"),void 0!==c&&null!=c&&(c.innerHTML=this._options.skipLabel)):this._introItems.length-1==this._currentStep||1==this._introItems.length?(void 0!==c&&null!=c&&(c.innerHTML=this._options.doneLabel,c.className+=" introjs-donebutton"),void 0!==h&&null!=h&&(h.className="introjs-button introjs-prevbutton"),1==this._options.hideNext?(void 0!==p&&null!=p&&(p.className="introjs-button introjs-nextbutton introjs-hidden"),void 0!==h&&null!=h&&(h.className+=" introjs-fullbutton")):void 0!==p&&null!=p&&(p.className="introjs-button introjs-nextbutton introjs-disabled"),void 0!==p&&null!=p&&(p.tabIndex="-1")):(void 0!==c&&null!=c&&(c.className="introjs-button introjs-skipbutton"),void 0!==h&&null!=h&&(h.className="introjs-button introjs-prevbutton"),void 0!==p&&null!=p&&(p.className="introjs-button introjs-nextbutton"),void 0!==c&&null!=c&&(c.innerHTML=this._options.skipLabel)),void 0!==p&&null!=p&&p.focus(),function _setShowElement(t){if(t.element instanceof SVGElement)for(var e=t.element.parentNode;null!=t.element.parentNode&&e.tagName&&"body"!==e.tagName.toLowerCase();)"svg"===e.tagName.toLowerCase()&&_setClass(e,"introjs-showElement introjs-relativePosition"),e=e.parentNode;_setClass(t.element,"introjs-showElement");var i=_getPropValue(t.element,"position");"absolute"!==i&&"relative"!==i&&"fixed"!==i&&_setClass(t.element,"introjs-relativePosition");e=t.element.parentNode;for(;null!=e&&e.tagName&&"body"!==e.tagName.toLowerCase();){var n=_getPropValue(e,"z-index"),o=parseFloat(_getPropValue(e,"opacity")),s=_getPropValue(e,"transform")||_getPropValue(e,"-webkit-transform")||_getPropValue(e,"-moz-transform")||_getPropValue(e,"-ms-transform")||_getPropValue(e,"-o-transform");(/[0-9]+/.test(n)||o<1||"none"!==s&&void 0!==s)&&(e.className+=" introjs-fixParent"),e=e.parentNode}}(t),void 0!==this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,t.element)}function _scrollTo(t,e,i){if(this._options.scrollToElement){if("tooltip"===t)var n=i.getBoundingClientRect();else n=e.element.getBoundingClientRect();if(!function _elementInViewport(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom+80<=window.innerHeight&&e.right<=window.innerWidth}(e.element)){var o=_getWinSize().height,s=n.bottom-(n.bottom-n.top);n.bottom;s<0||e.element.clientHeight>o?window.scrollBy(0,n.top-(o/2-n.height/2)-this._options.scrollPadding):window.scrollBy(0,n.top-(o/2-n.height/2)+this._options.scrollPadding)}}}function _removeShowElement(){for(var t=document.querySelectorAll(".introjs-showElement"),e=0,i=t.length;e<i;e++){_removeClass(t[e],/introjs-[a-zA-Z]+/g)}}function _setClass(t,e){if(t instanceof SVGElement){var i=t.getAttribute("class")||"";t.setAttribute("class",i+" "+e)}else t.className+=" "+e}function _removeClass(t,e){if(t instanceof SVGElement){var i=t.getAttribute("class")||"";t.setAttribute("class",i.replace(e,"").replace(/^\s+|\s+$/g,""))}else t.className=t.className.replace(e,"").replace(/^\s+|\s+$/g,"")}function _getPropValue(t,e){var i="";return t.currentStyle?i=t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle&&(i=document.defaultView.getComputedStyle(t,null).getPropertyValue(e)),i&&i.toLowerCase?i.toLowerCase():i}function _isFixed(t){var e=t.parentNode;return!(!e||"HTML"===e.nodeName)&&("fixed"==_getPropValue(t,"position")||_isFixed(e))}function _getWinSize(){if(null!=window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var t=document.documentElement;return{width:t.clientWidth,height:t.clientHeight}}function _addOverlayLayer(t){var e=document.createElement("div"),i="",n=this;if(e.className="introjs-overlay",t.tagName&&"body"!==t.tagName.toLowerCase()){var o=_getOffset(t);o&&(i+="width: "+o.width+"px; height:"+o.height+"px; top:"+o.top+"px;left: "+o.left+"px;",e.setAttribute("style",i))}else i+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",e.setAttribute("style",i);return t.appendChild(e),e.onclick=function(){1==n._options.exitOnOverlayClick&&_exitIntro.call(n,t)},setTimeout((function(){i+="opacity: "+n._options.overlayOpacity.toString()+";",e.setAttribute("style",i)}),10),!0}function _removeHintTooltip(){var t=this._targetElement.querySelector(".introjs-hintReference");if(t){var e=t.getAttribute("data-step");return t.parentNode.removeChild(t),e}}function _populateHints(t){if(this._introItems=[],this._options.hints)for(var e=0,i=this._options.hints.length;e<i;e++){var n=_cloneObject(this._options.hints[e]);"string"==typeof n.element&&(n.element=document.querySelector(n.element)),n.hintPosition=n.hintPosition||this._options.hintPosition,n.hintAnimation=n.hintAnimation||this._options.hintAnimation,null!=n.element&&this._introItems.push(n)}else{var o=t.querySelectorAll("*[data-hint]");if(o.length<1)return!1;for(e=0,i=o.length;e<i;e++){var s=o[e],r=s.getAttribute("data-hintAnimation");r=r?"true"==r:this._options.hintAnimation,this._introItems.push({element:s,hint:s.getAttribute("data-hint"),hintPosition:s.getAttribute("data-hintPosition")||this._options.hintPosition,hintAnimation:r,tooltipClass:s.getAttribute("data-tooltipClass"),position:s.getAttribute("data-position")||this._options.tooltipPosition})}}_addHints.call(this),document.addEventListener?(document.addEventListener("click",_removeHintTooltip.bind(this),!1),window.addEventListener("resize",_reAlignHints.bind(this),!0)):document.attachEvent&&(document.attachEvent("onclick",_removeHintTooltip.bind(this)),document.attachEvent("onresize",_reAlignHints.bind(this)))}function _reAlignHints(){for(var t=0,e=this._introItems.length;t<e;t++){var i=this._introItems[t];void 0!==i.targetElement&&_alignHintPosition.call(this,i.hintPosition,i.element,i.targetElement)}}function _hideHint(t){_removeHintTooltip.call(this);var e=this._targetElement.querySelector('.introjs-hint[data-step="'+t+'"]');e&&(e.className+=" introjs-hidehint"),void 0!==this._hintCloseCallback&&this._hintCloseCallback.call(this,t)}function _hideHints(){var t=this._targetElement.querySelectorAll(".introjs-hint");if(t&&t.length>0)for(var e=0;e<t.length;e++)_hideHint.call(this,t[e].getAttribute("data-step"))}function _showHints(){var t=this._targetElement.querySelectorAll(".introjs-hint");if(t&&t.length>0)for(var e=0;e<t.length;e++)_showHint.call(this,t[e].getAttribute("data-step"));else _populateHints.call(this,this._targetElement)}function _showHint(t){var e=this._targetElement.querySelector('.introjs-hint[data-step="'+t+'"]');e&&(e.className=e.className.replace(/introjs\-hidehint/g,""))}function _removeHints(){var t=this._targetElement.querySelectorAll(".introjs-hint");if(t&&t.length>0)for(var e=0;e<t.length;e++)_removeHint.call(this,t[e].getAttribute("data-step"))}function _removeHint(t){var e=this._targetElement.querySelector('.introjs-hint[data-step="'+t+'"]');e&&e.parentNode.removeChild(e)}function _addHints(){var t=this,e=document.querySelector(".introjs-hints");if(null!=e)i=e;else{var i=document.createElement("div");i.className="introjs-hints"}for(var n=0,o=this._introItems.length;n<o;n++){var s=this._introItems[n];if(!document.querySelector('.introjs-hint[data-step="'+n+'"]')){var r=document.createElement("a");_setAnchorAsButton(r),function(e,i,n){e.onclick=function(e){var i=e||window.event;i.stopPropagation&&i.stopPropagation(),null!=i.cancelBubble&&(i.cancelBubble=!0),_showHintDialog.call(t,n)}}(r,0,n),r.className="introjs-hint",s.hintAnimation||(r.className+=" introjs-hint-no-anim"),_isFixed(s.element)&&(r.className+=" introjs-fixedhint");var l=document.createElement("div");l.className="introjs-hint-dot";var a=document.createElement("div");a.className="introjs-hint-pulse",r.appendChild(l),r.appendChild(a),r.setAttribute("data-step",n),s.targetElement=s.element,s.element=r,_alignHintPosition.call(this,s.hintPosition,r,s.targetElement),i.appendChild(r)}}document.body.appendChild(i),void 0!==this._hintsAddedCallback&&this._hintsAddedCallback.call(this)}function _alignHintPosition(t,e,i){var n=_getOffset.call(this,i),o=20,s=20;switch(t){default:case"top-left":e.style.left=n.left+"px",e.style.top=n.top+"px";break;case"top-right":e.style.left=n.left+n.width-o+"px",e.style.top=n.top+"px";break;case"bottom-left":e.style.left=n.left+"px",e.style.top=n.top+n.height-s+"px";break;case"bottom-right":e.style.left=n.left+n.width-o+"px",e.style.top=n.top+n.height-s+"px";break;case"middle-left":e.style.left=n.left+"px",e.style.top=n.top+(n.height-s)/2+"px";break;case"middle-right":e.style.left=n.left+n.width-o+"px",e.style.top=n.top+(n.height-s)/2+"px";break;case"middle-middle":e.style.left=n.left+(n.width-o)/2+"px",e.style.top=n.top+(n.height-s)/2+"px";break;case"bottom-middle":e.style.left=n.left+(n.width-o)/2+"px",e.style.top=n.top+n.height-s+"px";break;case"top-middle":e.style.left=n.left+(n.width-o)/2+"px",e.style.top=n.top+"px"}}function _showHintDialog(t){var e=document.querySelector('.introjs-hint[data-step="'+t+'"]'),i=this._introItems[t];void 0!==this._hintClickCallback&&this._hintClickCallback.call(this,e,i,t);var n=_removeHintTooltip.call(this);if(parseInt(n,10)!=t){var o=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),l=document.createElement("div");o.className="introjs-tooltip",o.onclick=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},s.className="introjs-tooltiptext";var a=document.createElement("p");a.innerHTML=i.hint;var c=document.createElement("a");c.className="introjs-button",c.innerHTML=this._options.hintButtonLabel,c.onclick=_hideHint.bind(this,t),s.appendChild(a),s.appendChild(c),r.className="introjs-arrow",o.appendChild(r),o.appendChild(s),this._currentStep=e.getAttribute("data-step"),l.className="introjs-tooltipReferenceLayer introjs-hintReference",l.setAttribute("data-step",e.getAttribute("data-step")),_setHelperLayerPosition.call(this,l),l.appendChild(o),document.body.appendChild(l),_placeTooltip.call(this,e,o,r,null,!0)}}function _getOffset(t){var e={},i=document.body,n=document.documentElement,o=window.pageYOffset||n.scrollTop||i.scrollTop,s=window.pageXOffset||n.scrollLeft||i.scrollLeft;if(t instanceof SVGElement){var r=t.getBoundingClientRect();e.top=r.top+o,e.width=r.width,e.height=r.height,e.left=r.left+s}else{e.width=t.offsetWidth,e.height=t.offsetHeight;for(var l=0,a=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)l+=t.offsetLeft,a+=t.offsetTop,t=t.offsetParent;e.top=a,e.left=l}return e}function _getProgress(){return parseInt(this._currentStep+1,10)/this._introItems.length*100}var introJs=function(t){if("object"==typeof t)return new IntroJs(t);if("string"==typeof t){var e=document.querySelector(t);if(e)return new IntroJs(e);throw new Error("There is no element with given selector.")}return new IntroJs(document.body)};return introJs.version="2.6.0",introJs.fn=IntroJs.prototype={clone:function(){return new IntroJs(this)},setOption:function(t,e){return this._options[t]=e,this},setOptions:function(t){return this._options=function _mergeOptions(t,e){var i={};for(var n in t)i[n]=t[n];for(var n in e)i[n]=e[n];return i}(this._options,t),this},start:function(){return _introForElement.call(this,this._targetElement),this},goToStep:function(t){return _goToStep.call(this,t),this},addStep:function(t){return this._options.steps||(this._options.steps=[]),this._options.steps.push(t),this},addSteps:function(t){if(t.length){for(var e=0;e<t.length;e++)this.addStep(t[e]);return this}},goToStepNumber:function(t){return _goToStepNumber.call(this,t),this},nextStep:function(){return _nextStep.call(this),this},previousStep:function(){return _previousStep.call(this),this},exit:function(){return _exitIntro.call(this,this._targetElement),this},refresh:function(){return _refresh.call(this),this},onbeforechange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onbeforechange was not a function");return this._introBeforeChangeCallback=t,this},onchange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onchange was not a function.");return this._introChangeCallback=t,this},onafterchange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onafterchange was not a function");return this._introAfterChangeCallback=t,this},oncomplete:function(t){if("function"!=typeof t)throw new Error("Provided callback for oncomplete was not a function.");return this._introCompleteCallback=t,this},onhintsadded:function(t){if("function"!=typeof t)throw new Error("Provided callback for onhintsadded was not a function.");return this._hintsAddedCallback=t,this},onhintclick:function(t){if("function"!=typeof t)throw new Error("Provided callback for onhintclick was not a function.");return this._hintClickCallback=t,this},onhintclose:function(t){if("function"!=typeof t)throw new Error("Provided callback for onhintclose was not a function.");return this._hintCloseCallback=t,this},onexit:function(t){if("function"!=typeof t)throw new Error("Provided callback for onexit was not a function.");return this._introExitCallback=t,this},addHints:function(){return _populateHints.call(this,this._targetElement),this},hideHint:function(t){return _hideHint.call(this,t),this},hideHints:function(){return _hideHints.call(this),this},showHint:function(t){return _showHint.call(this,t),this},showHints:function(){return _showHints.call(this),this},removeHints:function(){return _removeHints.call(this),this},removeHint:function(t){return _removeHint.call(this,t),this},showHintDialog:function(t){return _showHintDialog.call(this,t),this}},t.introJs=introJs,introJs}));